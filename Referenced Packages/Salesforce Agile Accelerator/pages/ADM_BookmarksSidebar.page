<apex:page id="bookmarksPage" title="Bookmarks" controller="agf.ADM_BookmarksExtension" sidebar="false" showHeader="false">    <apex:outputPanel layout="block" id="bigOutterWrapper">        <apex:stylesheet value="{!$Resource.agf__ADM_common_css}"/>        <apex:includeScript id="includeScriptADMcommonJs" value="{!URLFOR($Resource.agf__ADM_common_js)}"/>        <apex:stylesheet value="{!$Resource.agf__CommonStyles}" />        <script type="text/javascript"            src="{!URLFOR($Resource.DojoJS, 'dojo/dojo.js')}"            djConfig="parseOnLoad:true, isDebug:false"></script>        <script type="text/javascript">            dojo.require("dojo._base.html");            dojo.require("dojo._base.query");                    var t = null;		function timer()		{			t = setTimeout("updateBookmarksHeight()", 1000);		}		timer();        </script>        <style type="text/css">            .list td,.list tr {                padding: 0;                margin: 0;                background:#CFEEF8;                            }            body, actionFooter_dark{              background:#CFEEF8;            }                    .tooltipbody {               padding:1px;               width:160px;            }        </style>            <apex:pageMessages id="pm"></apex:pageMessages>        <apex:form id="bookmarksForm">            <apex:outputPanel layout="block" id="bookmarksFormOutputPanel">                <table cellpadding="0" cellspacing="0" style="width:160px;background:#CFEEF8 !important;border:0px;">                    <tbody>                        <tr>                            <td valign="top">                                <apex:image url="{!URLFOR($Resource.agf__silkIcons, 'icons/add.png')}"                                                   id="addBookmarkIcon" alt="Bookmark this page" title="Bookmark this page"                                    onclick="dojo.addClass(this,'hidden');showBookmarkForm();" />                            </td>                            <td valign="top">                                <apex:outputPanel layout="block" id="newBoookmarkForm"                                    styleClass="hidden center">                                    <table style="width:150px; padding:0; margin:0;background:#CFEEF8 !important;border:0px;" cellpadding="0" cellspacing="0">                                        <tr>                                            <th style="text-align:right;">Title</th>                                            <td><apex:inputField value="{!newBookmark.agf__Title__c}" id="bookmarkTitle" style="width:100px" /></td>                                        </tr>                                        <tr>                                            <th style="text-align:right;">URL</th>                                            <td><apex:inputField value="{!newBookmark.agf__URL__c}" id="bookmarkUrl" style="width:100px;"/></td>                                        </tr>                                    </table>                                </apex:outputPanel>                            </td>                        </tr>                    </tbody>                </table>            </apex:outputPanel>            <apex:outputPanel layout="block" id="commandButtons" styleClass="hidden">                <apex:commandButton action="{!save}" title="Save" value="Save" />                <input type="button" class="btn" title="Cancel" value="Cancel" onclick="clearNewBookmark();" />            </apex:outputPanel>            <apex:outputPanel id="dndOuterWrapper">                <apex:repeat value="{!bookmarks}" var="bookmark" id="bookmarkOutputPanel" rendered="{!NOT(ISNULL(bookmarks))}">                    <table border="0" cellspacing="0" cellpadding="0" style="padding: 0; margin: 0; width: 90%;">                        <tr id="tr_{!bookmark.Id}">                             <td style="width: 10px;">                                 <apex:commandLink action="{!deleteBookmark}">                                     <apex:image url="{!$Resource.agf__ajaxloadersmall}" id="ajaxLoaderSmall" styleClass="hidden" />                                     <apex:image url="{!$Resource.agf__IconDelete}"                                         id="deleteBookmarkIcon" alt="Delete Bookmark"                                         title="Delete Bookmark" styleClass="opacity_40_percent deleteBookmarkIcon"                                         onmouseover="dojo.removeClass(this,'opacity_40_percent');"                                         onmouseout="dojo.addClass(this,'opacity_40_percent');"                                         onclick="dojo.addClass(this,'hidden');dojo.removeClass(dojo.byId('{!$Component.ajaxLoaderSmall}'),'hidden');" />                                     <apex:param name="bookmarkId" value="{!bookmark.Id}" assignTo="{!bookmarkId}" />                                 </apex:commandLink>                                 <apex:image url="{!$Resource.agf__IconUndo}"                                     id="revertBookmarkEdit" alt="Revert Bookmark Edit"                                     title="Revert Bookmark Edit"                                     styleClass="opacity_40_percent editingData revertBookmarkIcon"                                     onmouseover="dojo.removeClass(this,'opacity_40_percent');"                                     onmouseout="dojo.addClass(this,'opacity_40_percent');"                                     onclick="dojo.removeClass(dojo.byId('{!$Component.deleteBookmarkIcon}'),'hidden');copyValues(dojo.byId('{!bookmark.id}_o_Title_value'),dojo.byId('{!$Component.Title_edit}')); dojo.removeClass(dojo.byId('{!bookmark.id}_Title_col'),'editing');dojo.addClass(this,'editingData');dojo.removeClass(dojo.byId('{!$Component.editBookmarkIcon}'),'editingData');revertIfNotEditingBookmarks();" />                             </td>                             <td style="width:10px;">                                 <apex:image url="{!URLFOR($Resource.agf__silkIcons, 'icons/pencil.png')}"                                     id="editBookmarkIcon" alt="Rename Bookmark"                                     title="Rename Bookmark"                                     styleClass="adm_imgPadding opacity_40_percent editBookmarkIcon"                                     onmouseover="dojo.removeClass(this,'opacity_40_percent');"                                     onmouseout="dojo.addClass(this,'opacity_40_percent');"                                     onclick="dojo.addClass(dojo.byId('{!$Component.deleteBookmarkIcon}'),'hidden');dojo.addClass(dojo.byId('{!bookmark.id}_Title_col'),'editing');dojo.addClass(this,'editingData');dojo.removeClass(dojo.byId('{!$Component.revertBookmarkEdit}'),'editingData');initEditingBookmark();" />                                                                             </td>                             <td id="{!bookmark.id}_Title_col"                                 onmouseover="dojo.addClass(this,'mouseoverEdit');"                                 onmouseout="dojo.removeClass(this,'mouseoverEdit');" style="padding-left:5px;"                                 title="Link to {!bookmark.agf__URL__c}">                                 <span id="{!bookmark.id}_Title_disp" class="displayData">                                    <apex:outputText rendered="{!ISNULL(bookmark.agf__Title__c)}">&nbsp;</apex:outputText>                                    <apex:outputLink value="{!bookmark.agf__URL__c}" id="bookmarkLink" rendered="{!NOT(ISNULL(bookmark.agf__Title__c))}" target="_top">                                        {!bookmark.agf__Title__c}                                    </apex:outputLink>                                </span>                                <span id="{!bookmark.id}_Title_edit" class="editingData">                                    <apex:inputField id="Title_edit" value="{!bookmark.agf__Title__c}" style="width:90%;" styleClass="Title_edit {!bookmark.id}_o_Title_value"/>                                    <input type="hidden" id="{!bookmark.id}_o_Title_value" value="{!bookmark.agf__Title__c}" />                                </span>                            </td>                        </tr>                    </table>                </apex:repeat>                <script type="text/javascript">                    function getIdFromClassName(className) {                        var indexOfPrefix = className.indexOf("{!bookmarkPrefix}");                        return className.substring(indexOfPrefix,indexOfPrefix + 18);                    }                                        function isEditing() {                        var isEditingData = false;                        var els = dojo.query(".revertBookmarkIcon").length;                        dojo.query(".revertBookmarkIcon").forEach(function(node, index, arr) {                            if(node.className.indexOf("editingData") == -1) {                                isEditingData = true;                            }                        });                        return isEditingData;                    }                                        function showBookmarkForm() {                        dojo.removeClass(dojo.byId('{!$Component.newBoookmarkForm}'),'hidden');                        updateNewBookmark(window.parent.document.title,top.location);                        initEditingBookmark();                    }                                        function updateBookmarksHeight() {                        parent.document.getElementById('ADM_BookmarksSidebar').style.height = dojo.byId('{!$Component.bigOutterWrapper}').scrollHeight + 'px';                                                //clear the timeout if set                        if(typeof t != 'undefined' && t != null) {                            clearTimeout(t);                        }                    }                                        function initEditingBookmark() {                                    dojo.removeClass(dojo.byId('{!$Component.commandButtons}'),'hidden');                        updateBookmarksHeight();                    }                                        function showAllElements(className,cls) {                        dojo.query("." + className).forEach(function(node, index, arr) {                            if(node.className.indexOf(cls) > -1) dojo.removeClass(node,cls);                        });                    }                                        function hideAllElements(className,cls) {                        dojo.query("." + className).forEach(function(node, index, arr) {                            if(node.className.indexOf(cls) == -1) dojo.addClass(node,cls);                        });                    }                                        function copyAllValuesBack(className,prefix) {                        dojo.query("." + className).forEach(function(node, index, arr) {                            Id = getIdFromClassName(node.className);                            copyValues(dojo.byId(node.className.substring(node.className.indexOf(prefix))),dojo.byId(node.id));                            dojo.removeClass(dojo.byId(Id + '_Title_col'),'editing');                        });                                        }                                        function revertEditingBookmarks() {                        dojo.addClass(dojo.byId('{!$Component.commandButtons}'),'hidden');                        dojo.addClass(dojo.byId('{!$Component.newBoookmarkForm}'),'hidden');                        dojo.addClass(dojo.byId('{!$Component.addBookmarkIcon}'),'hidden');                        dojo.removeClass(dojo.byId('{!$Component.addBookmarkIcon}'),'hidden');                        showAllElements('deleteBookmarkIcon','hidden');                        showAllElements('editBookmarkIcon','editingData');                        hideAllElements('revertBookmarkIcon','editingData');                        copyAllValuesBack('Title_edit','{!bookmarkPrefix}');                        updateBookmarksHeight();                    }                                        function revertIfNotEditingBookmarks() {                       if(!isEditing()) revertEditingBookmarks();                    }                                          function two() {                        dojo.addClass(dojo.byId('{!$Component.addBookmarkIcon}'),'hidden');                    }                                        function clearNewBookmark() {                        updateNewBookmark('','');                        revertEditingBookmarks();                        updateBookmarksHeight();                        }                                        function updateNewBookmark(titleValue, urlValue) {                        title = dojo.byId('{!$Component.bookmarkTitle}');                        if(title) {                            title.value = titleValue.replace(/~ salesforce\.com - Developer Edition/ig, "");;                        }                        url = dojo.byId('{!$Component.bookmarkUrl}');                        if(url) {                            url.value = urlValue;                        }                    }                </script>            </apex:outputPanel>                           <apex:panelGrid columns="2" styleClass="adm_table total_row" rendered="{!setController.resultSize > 5}">                <apex:outputPanel styleclass="">{!rowStart} - {!rowEnd} of {!setController.resultSize}</apex:outputPanel>                <apex:outputPanel style="width:100%;">                    <apex:image url="{!URLFOR($Resource.agf__silkIcons, 'icons/resultset_first.png')}" rendered="{!NOT(setController.hasPrevious)}" style="opacity:0.4;filter:alpha(opacity=40)"/>                    <apex:image url="{!URLFOR($Resource.agf__silkIcons, 'icons/resultset_previous.png')}" rendered="{!NOT(setController.hasPrevious)}" style="opacity:0.4;filter:alpha(opacity=40)"/>                                  <apex:commandLink action="{!setController.first}" rendered="{!setController.hasPrevious}" styleclass=""><!-- onclick="overlay('Loading...')" -->                                    <apex:image url="{!URLFOR($Resource.agf__silkIcons, 'icons/resultset_first.png')}"/>                    </apex:commandlink>                      <apex:commandLink action="{!setController.previous}" rendered="{!setController.hasPrevious}" styleclass=""><!-- onclick="overlay('Loading...')"  -->                        <apex:image url="{!URLFOR($Resource.agf__silkIcons, 'icons/resultset_previous.png')}"/>                    </apex:commandlink>                    <apex:image url="{!URLFOR($Resource.agf__silkIcons, 'icons/resultset_next.png')}" rendered="{!NOT(setController.hasNext)}" style="opacity:0.4;filter:alpha(opacity=40)"/>                    <apex:image url="{!URLFOR($Resource.agf__silkIcons, 'icons/resultset_last.png')}" rendered="{!NOT(setController.hasNext)}" style="opacity:0.4;filter:alpha(opacity=40)"/>                                  <apex:commandLink action="{!setController.next}" rendered="{!setController.hasNext}" styleclass=""><!-- onclick="overlay('Loading...')"  -->                        <apex:image url="{!URLFOR($Resource.agf__silkIcons, 'icons/resultset_next.png')}"/>                    </apex:commandlink>                      <apex:commandLink action="{!setController.last}" rendered="{!setController.hasNext}" styleclass=""><!-- onclick="overlay('Loading...')"  -->                        <apex:image url="{!URLFOR($Resource.agf__silkIcons, 'icons/resultset_last.png')}"/>                    </apex:commandlink>                  </apex:outputPanel>                    </apex:panelGrid>                </apex:form>        <script type="text/javascript" language="javascript">            updateBookmarksHeight();        </script>    </apex:outputPanel></apex:page>